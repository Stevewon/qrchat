<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>Firebase ì—°ê²° í…ŒìŠ¤íŠ¸</title>
    <style>
        body {
            font-family: monospace;
            padding: 20px;
            background: #1e1e1e;
            color: #00ff00;
        }
        .result {
            margin: 10px 0;
            padding: 10px;
            border: 1px solid #333;
            background: #2d2d2d;
        }
        .success { color: #00ff00; }
        .error { color: #ff0000; }
        .info { color: #00aaff; }
    </style>
</head>
<body>
    <h1>ğŸ”¥ Firebase ì—°ê²° ë° ê¶Œí•œ í…ŒìŠ¤íŠ¸</h1>
    <div id="results"></div>

    <script type="module">
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js';
        import { getStorage, ref, listAll } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-storage.js';
        import { getFirestore, collection, getDocs } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js';

        const firebaseConfig = {
            apiKey: "AIzaSyDEoFb4ovEEyrSKs7Se9JToLzHA26A6ga8",
            projectId: "qrchat-b7a67",
            storageBucket: "qrchat-b7a67.firebasestorage.app",
            appId: "1:745884272823:android:bc0cc4d389b36ee1d9e532"
        };

        function log(message, type = 'info') {
            const results = document.getElementById('results');
            const div = document.createElement('div');
            div.className = `result ${type}`;
            div.innerHTML = `[${new Date().toISOString()}] ${message}`;
            results.appendChild(div);
            console.log(message);
        }

        async function runTests() {
            try {
                log('ğŸ”¥ Firebase ì´ˆê¸°í™” ì¤‘...', 'info');
                const app = initializeApp(firebaseConfig);
                log('âœ… Firebase ì´ˆê¸°í™” ì„±ê³µ!', 'success');

                // Firestore í…ŒìŠ¤íŠ¸
                log('', 'info');
                log('ğŸ“Š Firestore ì—°ê²° í…ŒìŠ¤íŠ¸...', 'info');
                const db = getFirestore(app);
                
                try {
                    const querySnapshot = await getDocs(collection(db, 'sticker_packs'));
                    log(`âœ… Firestore ì½ê¸° ì„±ê³µ! ë¬¸ì„œ ìˆ˜: ${querySnapshot.size}`, 'success');
                    
                    if (querySnapshot.size > 0) {
                        querySnapshot.forEach((doc) => {
                            const data = doc.data();
                            log(`   ğŸ“¦ ${doc.id}: ${data.pack_name || 'Unnamed'} (${(data.stickers || []).length} stickers)`, 'info');
                        });
                    } else {
                        log('âš ï¸  ë“±ë¡ëœ ìŠ¤í‹°ì»¤íŒ©ì´ ì—†ìŠµë‹ˆë‹¤', 'info');
                    }
                } catch (firestoreError) {
                    log(`âŒ Firestore ì½ê¸° ì‹¤íŒ¨: ${firestoreError.code} - ${firestoreError.message}`, 'error');
                    log(`   ğŸ‘‰ í•´ê²°ì±…: Firebase Consoleì—ì„œ Firestore Security Rules í™•ì¸`, 'error');
                    log(`   ğŸ‘‰ URL: https://console.firebase.google.com/project/qrchat-b7a67/firestore/rules`, 'error');
                }

                // Storage í…ŒìŠ¤íŠ¸
                log('', 'info');
                log('ğŸ“¦ Storage ì—°ê²° í…ŒìŠ¤íŠ¸...', 'info');
                const storage = getStorage(app);
                
                try {
                    const storageRef = ref(storage, 'stickers');
                    const result = await listAll(storageRef);
                    log(`âœ… Storage ì½ê¸° ì„±ê³µ! í´ë” ìˆ˜: ${result.prefixes.length}`, 'success');
                    
                    result.prefixes.forEach((folderRef) => {
                        log(`   ğŸ“ ${folderRef.name}`, 'info');
                    });
                } catch (storageError) {
                    log(`âŒ Storage ì½ê¸° ì‹¤íŒ¨: ${storageError.code} - ${storageError.message}`, 'error');
                    log(`   ğŸ‘‰ í•´ê²°ì±…: Firebase Consoleì—ì„œ Storage Rules í™•ì¸`, 'error');
                    log(`   ğŸ‘‰ URL: https://console.firebase.google.com/project/qrchat-b7a67/storage/rules`, 'error');
                }

                log('', 'info');
                log('ğŸ¯ í…ŒìŠ¤íŠ¸ ì™„ë£Œ!', 'success');

            } catch (error) {
                log(`âŒ ì¹˜ëª…ì  ì˜¤ë¥˜: ${error.message}`, 'error');
                console.error('Full error:', error);
            }
        }

        // í˜ì´ì§€ ë¡œë“œ ì‹œ í…ŒìŠ¤íŠ¸ ì‹¤í–‰
        runTests();
    </script>
</body>
</html>
