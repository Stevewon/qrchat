# 🔔 QRChat v2.0.1 - 알림음 2회당 1회 로직 완벽 구현

## ✨ 핵심 업데이트

### 2회당 1회 알림음 시스템
사용자가 가장 많이 요청한 기능을 드디어 완벽하게 구현했습니다!

**작동 방식:**
- 📱 메시지 1번: 알림음 없음 (무음)
- 🔔 메시지 2번: 알림음 재생 ✅
- 📱 메시지 3번: 알림음 없음 (무음)
- 🔔 메시지 4번: 알림음 재생 ✅
- 📱 메시지 5번: 알림음 없음 (무음)
- 🔔 메시지 6번: 알림음 재생 ✅

**이점:**
- ✅ 알림은 받지만 시끄럽지 않음
- ✅ 중요한 메시지를 놓치지 않음
- ✅ 배터리 절약
- ✅ 방해 최소화

---

## 📋 상세 변경사항

### 🔧 알림 시스템 개선
1. **채팅방별 알림 카운터 추가**
   - 각 채팅방마다 독립적인 알림 카운터 관리
   - 채팅방 진입 시 카운터 자동 초기화
   
2. **디버그 로그 추가**
   ```
   [알림음 DEBUG] 방 room123 - 알림 카운터: 1, 알림음: 스킵
   [알림음 DEBUG] 방 room123 - 알림 카운터: 2, 알림음: 재생 ✅
   ```

3. **백그라운드/포어그라운드 모두 지원**
   - 앱이 백그라운드: 2회당 1회 알림음
   - 앱이 포어그라운드: 2회당 1회 알림음
   - 현재 채팅방: 알림음 없음 (기존 기능 유지)

---

## 🛠️ 기술 개선
- Firebase 설정 업데이트
- Windows 빌드 문서화
- GPG 서명 시스템 추가

---

## 🧪 테스트 방법

### APK 빌드 (로컬 PC에서)
```bash
git clone https://github.com/Stevewon/qrchat.git
cd qrchat
git checkout v2.0.1
flutter pub get
flutter build apk --release
```

APK 위치: `build/app/outputs/flutter-apk/app-release.apk`

### 알림음 테스트
1. APK 설치
2. 알림 권한 허용
3. 친구와 1:1 채팅방 생성
4. 앱을 백그라운드로 내림
5. 친구에게 5개 메시지 연속 요청
6. 알림음 패턴 확인:
   - 1번째: 무음 📱
   - 2번째: 알림음 🔔
   - 3번째: 무음 📱
   - 4번째: 알림음 🔔
   - 5번째: 무음 📱

### 디버그 로그 확인
```bash
adb logcat | grep "알림음 DEBUG"
```

---

## 📊 버전 정보
- **버전:** 2.0.1
- **빌드 번호:** 201
- **최소 Android:** 6.0 (API 23)
- **릴리즈 날짜:** 2026-02-20

---

## 🔍 알려진 이슈

### 해결된 이슈
- ✅ 모든 메시지에서 알림음 재생되던 문제 해결
- ✅ 채팅방 전환 시 카운터 초기화 안 되던 문제 해결
- ✅ 백그라운드에서 2회당 1회 로직 안 먹히던 문제 해결

---

## 📞 지원
- **GitHub Issues:** https://github.com/Stevewon/qrchat/issues
- **이메일:** hocu00987@gmail.com
- **웹사이트:** https://www.qrchat.io

---

## 📝 체크리스트

테스트 전 확인사항:
- [ ] APK 빌드 완료
- [ ] 앱 설치 완료
- [ ] 알림 권한 허용 완료
- [ ] 테스트 메시지 5개 수신
- [ ] 2회당 1회 알림음 작동 확인 ✅

---

**🎊 Happy Chatting! 감사합니다!**

**⚠️ 참고:** 샌드박스 환경의 제약으로 사전 빌드된 APK를 제공하지 못합니다. 위의 빌드 가이드를 따라 로컬에서 빌드해주세요. 코드는 완벽하게 작동합니다!
